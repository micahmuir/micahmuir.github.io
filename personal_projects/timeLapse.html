<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Project Gallery — Timelapse Camera</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Site-wide CSS (applies the cardboard texture via <html> background, tokens, navbar, etc.) -->
  <link rel="stylesheet" href="../assets/css/style.css" />
  <!-- Open Sans (optional—kept for consistency) -->
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet" />
</head>

<body id="projects-detail">
  <!-- Navbar -->
  <nav class="navbar">
    <ul class="nav-links">
      <li><a href="../index.html">Home</a></li>
      <li><a href="../resume.html">Resume</a></li>
      <li><a href="../personal_projects.html">Projects</a></li>
      <li><a href="../about.html">About</a></li>
    </ul>
  </nav>

  <!-- highlight current nav link -->
  <script>
    (function(){
      const links = document.querySelectorAll('.nav-links a');
      const currentPath = window.location.pathname;
      links.forEach(link => {
        if (link.getAttribute('href') === currentPath) link.classList.add('active');
      });
    })();
  </script>

  <div class="page">
    <!-- Cardstock intro panel (title + paragraph on one paper sheet) -->
    <section class="paper-panel">
      <h1 class="page-title">Timelapse Camera</h1>
      <p>
        I’d been curious about adding “board-level camera” to my maker toolbox for quite some time. I finally
        picked up both global-shutter and rolling-shutter camera modules for the Raspberry Pi, and grabbed a Pi 5
        so I could use its two CSI ports. The goal: a flexible multi-camera system with Python tooling for capture
        and assembly into week-long timelapses.
      </p>
    </section>

    <!-- Gallery -->
    <div class="gallery" id="gallery">
      <div class="gallery-item"
           data-type="img"
           data-src="../assets/images/timelapse.jpeg"
           data-caption="One of the early captures while testing lens choices and exposure pipeline.">
        <img src="../assets/images/timelapse.jpeg" alt="Timelapse still frame">
      </div>

      <div class="gallery-item"
           data-type="video"
           data-src="https://www.youtube.com/embed/UCMqOSOKHzI"
           data-caption="A week-long timelapse shot and assembled with Python scripts.">
        <img src="https://img.youtube.com/vi/UCMqOSOKHzI/hqdefault.jpg" alt="Timelapse video thumbnail">
      </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
      <span class="lightbox-close" onclick="closeLightbox()">&times;</span>
      <span class="lightbox-nav lightbox-prev" onclick="prevLightbox()">&#10094;</span>
      <div class="lightbox-content" id="lightboxContent"></div>
      <span class="lightbox-nav lightbox-next" onclick="nextLightbox()">&#10095;</span>
    </div>
  </div>

  <!-- Lightbox scripts (same as your other project page) -->
  <script>
    const galleryItems = Array.from(document.querySelectorAll('.gallery-item'));
    let currentIndex = 0;

    function openLightbox(type, src, caption) {
      const contentEl = document.getElementById('lightboxContent');
      contentEl.classList.remove('show');

      setTimeout(() => {
        const html = (type === 'img')
          ? `<div style="display:flex;flex-direction:column;align-items:center;">
               <img src="${src}" alt="">
               <div class="lightbox-caption">${caption||''}</div>
             </div>`
          : `<div class="video-wrapper">
               <iframe src="${src}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
             </div>
             <div class="lightbox-caption">${caption||''}</div>`;

        contentEl.innerHTML = html;
        requestAnimationFrame(() => contentEl.classList.add('show'));
      }, 150);

      const lightbox = document.getElementById('lightbox');
      lightbox.classList.add('show');
      lightbox.style.display = 'flex';
    }

    function closeLightbox() {
      const lightbox = document.getElementById('lightbox');
      lightbox.classList.remove('show');
      setTimeout(() => {
        lightbox.style.display = 'none';
        document.getElementById('lightboxContent').innerHTML = '';
      }, 250);
    }

    function showLightbox(index) {
      const item = galleryItems[index];
      openLightbox(item.dataset.type, item.dataset.src, item.dataset.caption);
      currentIndex = index;
    }
    function nextLightbox() {
      currentIndex = (currentIndex + 1) % galleryItems.length;
      showLightbox(currentIndex);
    }
    function prevLightbox() {
      currentIndex = (currentIndex - 1 + galleryItems.length) % galleryItems.length;
      showLightbox(currentIndex);
    }

    galleryItems.forEach((item, index) => {
      item.addEventListener('click', () => showLightbox(index));
    });

    document.addEventListener('keydown', (e) => {
      const lightbox = document.getElementById('lightbox');
      if (!lightbox.classList.contains('show')) return;
      if (e.key === 'ArrowRight') nextLightbox();
      if (e.key === 'ArrowLeft')  prevLightbox();
      if (e.key === 'Escape')     closeLightbox();
    });

    // Swipe support
    let touchStartX = 0, touchEndX = 0;
    document.addEventListener('touchstart', e => { touchStartX = e.changedTouches[0].screenX; }, {passive:true});
    document.addEventListener('touchend',   e => { touchEndX   = e.changedTouches[0].screenX; handleSwipe(); }, {passive:true});
    function handleSwipe(){
      const lightbox = document.getElementById('lightbox');
      if (!lightbox || !lightbox.classList.contains('show')) return;
      if (touchEndX < touchStartX - 50) nextLightbox();
      if (touchEndX > touchStartX + 50) prevLightbox();
    }
  </script>

  <script src="/assets/js/main.js"></script>
</body>
</html>
