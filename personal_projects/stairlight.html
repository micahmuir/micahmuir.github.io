<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Project Gallery — Companion Stairlight</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Site-wide CSS (applies the cardboard texture via <html> background, tokens, navbar, etc.) -->
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../assets/css/style.css" />
</head>

<body id="projects-detail">
  <!-- Navbar -->
  <nav class="navbar">
    <ul class="nav-links">
      <li><a href="../index.html">Home</a></li>
      <li><a href="../resume.html">Resume</a></li>
      <li><a href="../personal_projects.html">Projects</a></li>
      <li><a href="../about.html">About</a></li>
    </ul>
  </nav>

  <script>
    (function(){
      const links = document.querySelectorAll('.nav-links a');
      const currentPath = window.location.pathname;
      links.forEach(link => {
        if (link.getAttribute('href') === currentPath) link.classList.add('active');
      });
    })();
  </script>

  <div class="page">
    <!-- Cardstock intro panel (title + paragraph on one paper sheet) -->
    <section class="paper-panel">
      <h1 class="page-title">Companion Stairlight</h1>
      <p>
        This project was born of frustration. Our very old, strangely wired house has the stairwell light switch
        at the bottom of the stairs. Late at night, that meant walking down in the dark, turning on the light,
        doing the thing, then turning it off and heading back up in darkness again. Usually with full arms,
        which meant putting everything down just to flip a switch. It was a pain, so I built a stair light that
        follows you automatically.
      </p>
    </section>

    <!-- Gallery -->
    <div class="gallery" id="gallery">
      <div class="gallery-item" data-type="img" data-src="../assets/images/stairlight1.jpeg"
           data-caption="A TFL03 ToF sensor measures distance along the stair axis—immune to ambient light. Mounted on a 1/4-20 arm and aimed up the hallway.">
        <img src="../assets/images/stairlight1.jpeg" alt="TFL03 ToF sensor aimed up hallway">
      </div>

      <div class="gallery-item" data-type="img" data-src="../assets/images/stairlight3.jpeg"
           data-caption="TFL03 serial distance data is bridged by an Arduino and broadcast over NRF24L01+ so future projects can subscribe.">
        <img src="../assets/images/stairlight3.jpeg" alt="Arduino + NRF24L01+ radio relay">
      </div>

      <div class="gallery-item" data-type="img" data-src="../assets/images/stairlight4.jpeg"
           data-caption="Low-profile printed enclosure for the controller—mounted with putty to avoid drilling in a rental.">
        <img src="../assets/images/stairlight4.jpeg" alt="Printed enclosure mounted on stair board">
      </div>

      <div class="gallery-item" data-type="img" data-src="../assets/images/stairlight6.jpeg"
           data-caption="Inside: Teensy 4.1 for headroom, network IO, and scalability. ~300 LEDs under the stairs in the current setup.">
        <img src="../assets/images/stairlight6.jpeg" alt="Controller internals with Teensy 4.1">
      </div>

      <div class="gallery-item" data-type="video" data-src="https://www.youtube.com/embed/VXFYuCdimaI"
           data-caption="Final setup in action — a light that moves with you.">
        <img src="https://img.youtube.com/vi/VXFYuCdimaI/hqdefault.jpg" alt="Companion Stairlight video">
      </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
      <span class="lightbox-close" onclick="closeLightbox()">&times;</span>
      <span class="lightbox-nav lightbox-prev" onclick="prevLightbox()">&#10094;</span>
      <div class="lightbox-content" id="lightboxContent"></div>
      <span class="lightbox-nav lightbox-next" onclick="nextLightbox()">&#10095;</span>
    </div>
  </div>

  <!-- Lightbox scripts -->
  <script>
    const galleryItems = Array.from(document.querySelectorAll('.gallery-item'));
    let currentIndex = 0;

    function openLightbox(type, src, caption) {
      const contentEl = document.getElementById('lightboxContent');
      contentEl.classList.remove('show');

      setTimeout(() => {
        const html = (type === 'img')
          ? `<div style="display:flex;flex-direction:column;align-items:center;">
               <img src="${src}" alt="">
               <div class="lightbox-caption">${caption||''}</div>
             </div>`
          : `<div class="video-wrapper">
               <iframe src="${src}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
             </div>
             <div class="lightbox-caption">${caption||''}</div>`;

        contentEl.innerHTML = html;
        requestAnimationFrame(() => contentEl.classList.add('show'));
      }, 150);

      const lightbox = document.getElementById('lightbox');
      lightbox.classList.add('show');
      lightbox.style.display = 'flex';
    }

    function closeLightbox() {
      const lightbox = document.getElementById('lightbox');
      lightbox.classList.remove('show');
      setTimeout(() => {
        lightbox.style.display = 'none';
        document.getElementById('lightboxContent').innerHTML = '';
      }, 250);
    }

    function showLightbox(index) {
      const item = galleryItems[index];
      openLightbox(item.dataset.type, item.dataset.src, item.dataset.caption);
      currentIndex = index;
    }
    function nextLightbox() {
      currentIndex = (currentIndex + 1) % galleryItems.length;
      showLightbox(currentIndex);
    }
    function prevLightbox() {
      currentIndex = (currentIndex - 1 + galleryItems.length) % galleryItems.length;
      showLightbox(currentIndex);
    }

    galleryItems.forEach((item, index) => {
      item.addEventListener('click', () => showLightbox(index));
    });

    document.addEventListener('keydown', (e) => {
      const lightbox = document.getElementById('lightbox');
      if (!lightbox.classList.contains('show')) return;
      if (e.key === 'ArrowRight') nextLightbox();
      if (e.key === 'ArrowLeft')  prevLightbox();
      if (e.key === 'Escape')     closeLightbox();
    });

    // Swipe support
    let touchStartX = 0, touchEndX = 0;
    document.addEventListener('touchstart', e => { touchStartX = e.changedTouches[0].screenX; }, {passive:true});
    document.addEventListener('touchend',   e => { touchEndX   = e.changedTouches[0].screenX; handleSwipe(); }, {passive:true});
    function handleSwipe(){
      const lightbox = document.getElementById('lightbox');
      if (!lightbox || !lightbox.classList.contains('show')) return;
      if (touchEndX < touchStartX - 50) nextLightbox();
      if (touchEndX > touchStartX + 50) prevLightbox();
    }
  </script>

  <script src="assets/js/main.js"></script>
</body>
</html>
